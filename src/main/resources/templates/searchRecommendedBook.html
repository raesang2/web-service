<!DOCTYPE html>
<html lang="ko">
<head>
    <th:block th:replace="~{common.html}"></th:block>
    <meta property="og:type" content="website"> 
    <meta property="og:title" content="κµ­λ¦½μ–΄λ¦°μ΄μ²­μ†λ…„λ„μ„κ΄€ μ‚¬μ„ μ¶”μ² λ„μ„"> 
    <meta property="og:description" content="κµ­λ¦½μ–΄λ¦°μ΄μ²­μ†λ…„λ„μ„κ΄€ μ‚¬μ„ μ¶”μ² λ„μ„λ¥Ό ν™•μΈν•΄λ³΄μ„Έμ”.">
    <meta property="og:url" content="https://kkidslife.com/searchRecommendedBookPage">
    <meta charset="UTF-8">
    <title>μ–΄λ¦°μ΄/μ²­μ†λ…„ μ¶”μ² λ„μ„</title>
    <link rel="stylesheet" href="/css/styles.css">
</head>
<body>
	<div class="container">
	<div class="top-bar">
	    <div class="top-left" th:replace="~{nav.html}"></div>
	    <div class="top-center" th:replace="~{titlebar.html :: title-bar(centerClass='search-title', titleText='μ–΄λ¦°μ΄/μ²­μ†λ…„ μ¶”μ² λ„μ„')}"></div>
	    <p class="sr-only">κµ­λ¦½μ–΄λ¦°μ΄μ²­μ†λ…„λ„μ„κ΄€ μ‚¬μ„ μ¶”μ² λ„μ„λ¥Ό ν™•μΈν•΄λ³΄μ„Έμ”.</p>
	    <div class="top-right"></div> <!-- μ¶”ν›„ λ²„νΌ λ“± μ„μΉμ© -->
	</div>

    <div id="notice">
        κµ­λ¦½μ–΄λ¦°μ΄μ²­μ†λ…„λ„μ„κ΄€ μ‚¬μ„ μ¶”μ² λ„μ„λ¥Ό ν™•μΈν•΄λ³΄μ„Έμ”.<br><br>
        λ°μ΄ν„° μ¶μ² : <a href="https://nlcy.go.kr/NLCY/contents/C10600000000.do" target="_blank">κµ­λ¦½μ–΄λ¦°μ΄μ²­μ†λ…„λ„μ„κ΄€ μ‚¬μ„ μ¶”μ² λ„μ„</a>
    </div>
	<form id="recommendedbookSearchForm">
	    <div class="form-group">
	        <label for="year" class="recommendedbookSearchLabel">μ¶”μ² μ—°λ„ & λ€μƒ</label>
	        <select id="year" name="year">
	            <option value="">μ „μ²΄</option>
	            <option th:each="y : ${yearList}" th:value="${y}" th:text="${y}"></option>
	        </select>
	        
	        <select id="target" name="target">
	            <option value="">μ „μ²΄</option>
	            <option th:each="t : ${targetList}" th:value="${t}" th:text="${t}"></option>
	        </select>
		</div>
		<div class="form-group">
	        <label for="keyword" class="recommendedbookSearchLabel">ν‚¤μ›λ“</label>
	        <input type="text" id="keyword" name="keyword" class="searchKeyword" placeholder="(μµμ…)μ±… μ λ©, μ €μ λ“±">  
		</div>
		
		<div class="form-group" style="text-align: center;">
	        <input type="submit" value="κ²€μƒ‰">
	    </div>
	</form>
	
	<div id="recommendedbook-result-summary"></div>
	<div id="recommendedbook-result-table"></div>

</div>

<script>
	document.getElementById('recommendedbookSearchForm').addEventListener('submit', function (e) {
	    e.preventDefault();
	    const year = document.getElementById('year').value;
	    const target = document.getElementById('target').value;
	    const keyword = document.getElementById('keyword').value;
	
	    fetch(`/searchRecommendedBook?year=${year}&target=${target}&keyword=${encodeURIComponent(keyword)}`)
	        .then(res => res.text())
	        .then(html => {
	            document.getElementById('recommendedbook-result-table').innerHTML = html;
	        });
	});

    function viewKcisaBookDetail(btn) {
		const title = btn.getAttribute("data-title");
		const isbn = btn.getAttribute("data-isbn");
		const rmonth = btn.getAttribute("data-rmonth");
		
        fetch('/api/searchKcisaBook?title=' + encodeURIComponent(title) + '&isbn=' + isbn)
            .then(response => {
                if (!response.ok) throw new Error("λ„μ„ μ •λ³΄λ¥Ό κ°€μ Έμ¤μ§€ λ»ν–μµλ‹λ‹¤.");
                return response.json();
            })
            .then(book => {
                const detailHtml = `
                	<img src="${book.image}" alt="λ„μ„ μ΄λ―Έμ§€" class="book-image">                
                    <p>
                    <a href="/searchLibraryPage/${isbn}?title=${book.title}" target="_blank" class="library-link">
                        π“ μ΄ λ„μ„λ¥Ό μ†μ¥ν• λ„μ„κ΄€ μ°ΎκΈ°
                    </a>
                	</p>
                	<p><strong>μ λ©:</strong> ${book.title}</p>
                    <p><strong>μ €μ:</strong> ${book.rights}</p>
                    <p><strong>μ¶”μ²μ—°μ›”:</strong> ${rmonth} </p>
                    <p><strong>μ±…μ†κ°:</strong> ${book.description}</p>
                `;
                document.getElementById('bookDetailArea').innerHTML = detailHtml;
                document.getElementById('bookModal').style.display = 'block';
            })
            .catch(error => {
                alert(error.message);
            });
    }

    function closeModal() {
        document.getElementById('bookModal').style.display = 'none';
    }
</script>	
</script>
</body>
</html>
